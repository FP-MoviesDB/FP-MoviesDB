!function($){var currentAjaxRequest=null;function handleAjaxResponse(response,position,post_id){let src_url=response.data.embed_url;$("#fp_player_response").html('<div class="pframe" style="visibility:hidden;"><iframe class="metaframe rptss" src="'+src_url+'" frameborder="0" scrolling="no" id="videoIframe" allow="autoplay; encrypted-media" allowfullscreen></iframe></div>'),$(".pframe").css("visibility","visible"),$(".loader-wrapper").hide(),$("#fp-backdrop-container").hide(),$("#fp_player_response iframe").on("error",(function(){"function"==typeof fpLog&&fpLog("JS","An error occurred while playing media."),$(".loader-wrapper").hide(),$("#fp-backdrop-container").css({filter:"blur(0) brightness(0.9)","-webkit-filter":"blur(0) brightness(0.9)"}).show(),$(".play-icon-wrapper").show(),$(".play-title-wrapper").show(),$(".fp_player_option").removeClass("on")}))}function handlePlayerOptionClick(element){var post_id=element.data("post"),position=element.data("position"),type=element.data("type"),pType=element.data("ptype");return null!==currentAjaxRequest&&("function"==typeof fpLog&&(fpLog("JS",currentAjaxRequest.readyState),fpLog("JS","Aborting previous request...")),currentAjaxRequest.abort(),currentAjaxRequest=null),$("#fp-backdrop-container").show(),$("#fp-backdrop-container").css({filter:"brightness(20%)"}),$(".play-icon-wrapper").hide(),$(".play-title-wrapper").hide(),element.hasClass("on")||($(".episode").removeClass("active"),$(".episode").removeClass("on"),$("ul.ajax_mode > li.fp_player_option").removeClass("active"),$("#fp_player_response").html(""),$(".loader-wrapper").show(),$(".fp_player_option").removeClass("on"),element.addClass("on"),element.addClass("active"),currentAjaxRequest=$.ajax({url:fp_pAjax.ajax_url,type:"POST",data:{action:"fp_player_ajax",post:post_id,position:position,type:type,pType:pType,nonce:fp_pAjax.nonce},success:function(t){handleAjaxResponse(t)},error:function(t){"function"==typeof fpLog&&fpLog("JS","Error: "+JSON.parse(t.responseText).data),$(".loader-wrapper").hide(),$("#fp-backdrop-container").css({filter:"blur(0) brightness(0.9)","-webkit-filter":"blur(0) brightness(0.9)"}).show(),$(".play-icon-wrapper").show(),$(".play-title-wrapper").show(),element.removeClass("on")},complete:function(){currentAjaxRequest=null}})),!1}$((function(){$(".movie-media-controller").length&&($(document).on("click","ul.ajax_mode > li.fp_player_option",(function(){handlePlayerOptionClick($(this))})),$(document).on("click",".play-icon-wrapper",(function(){$("ul.ajax_mode > li.fp_player_option").first().trigger("click")})))})),$((function(){if($(".tv-media-controller").length){var episodeCache={},currentSeason=null,initialLoadComplete=!1;$(document).on("click","ul.ajax_mode > li.fp_player_option",(function(){handlePlayerOptionClick($(this))})),$(document).on("click",".play-icon-wrapper",(function(){$("ul.ajax_mode > li.fp_player_option").length?$("ul.ajax_mode > li.fp_player_option").first().trigger("click"):$(".episode").length&&$(".episode:first").trigger("click")})),$("#season-selector").on("change",(function(){var selectedSeason=$(this).val().split("-")[1];currentSeason!==selectedSeason&&(initialLoadComplete=!1),toggleEpisodes(selectedSeason)}));var initialSeason=$("#season-selector").val().split("-")[1];currentSeason=initialSeason,toggleEpisodes(initialSeason),$(document).on("click",".episode-box",(function(){$(".episode-box").removeClass("active"),$("ul.ajax_mode > li.fp_player_option").removeClass("active"),$(".fp_player_option").removeClass("on"),$(this).addClass("active");var postId=$(this).data("postid"),season=$(this).data("season"),episode=$(this).data("episode"),cacheKey=`season-${season}-episode-${episode}`;if(episodeCache[cacheKey])return"function"==typeof fpLog&&fpLog("JS","Using cached data for: "+cacheKey),displayEpisodeSources(episodeCache[cacheKey],season,episode,postId),void(currentSeason!==season||initialLoadComplete?$(".episodes-sources .episode:first").trigger("click"):initialLoadComplete=!0);$.ajax({url:fp_pAjax.ajax_url,type:"POST",data:{action:"fetch_episode_sources",post_id:postId,season:season,episode:episode,nonce:fp_pAjax.nonce},success:function(response){episodeCache[cacheKey]=response,displayEpisodeSources(response,season,episode,postId),currentSeason!==season||initialLoadComplete?$(".episodes-sources .episode:first").trigger("click"):initialLoadComplete=!0},error:function(){"function"==typeof fpLog&&fpLog("JS","Failed to fetch episode details | Reload the page")}}),currentSeason=season})),$(document).on("click",".episode",(function(){!function(element){var postId=element.data("postid"),season=element.data("season"),episode=element.data("episode"),position=element.data("position")||1,type=element.data("type"),pType="tv";null!==currentAjaxRequest&&("function"==typeof fpLog&&fpLog("JS","Aborting previous request..."),currentAjaxRequest.abort(),currentAjaxRequest=null);$("#fp-backdrop-container").show(),$("#fp-backdrop-container").css({filter:"brightness(20%)"}),$(".play-icon-wrapper").hide(),$(".play-title-wrapper").hide(),element.hasClass("active")||($("ul.ajax_mode > li.fp_player_option").removeClass("active"),$(".fp_player_option").removeClass("on"),$(".episode").removeClass("active"),$(".episode").removeClass("on"),$("#fp_player_response").html(""),$(".loader-wrapper").show(),element.addClass("on"),element.addClass("active"),currentAjaxRequest=$.ajax({url:fp_pAjax.ajax_url,type:"POST",data:{action:"fp_player_ajax",post:postId,position:position,type:type,pType:pType,season:season,episode:episode,nonce:fp_pAjax.nonce},success:function(t){handleAjaxResponse(t)},error:function(t){"function"==typeof fpLog&&fpLog("JS","Error: "+JSON.parse(t.responseText).data),$(".loader-wrapper").hide(),$("#fp-backdrop-container").css({filter:"blur(0) brightness(0.9)","-webkit-filter":"blur(0) brightness(0.9)"}).show(),$(".play-icon-wrapper").show(),$(".play-title-wrapper").show(),element.removeClass("active")},complete:function(){currentAjaxRequest=null}}))}($(this))}))}function displayEpisodeSources(response,season,episode,postId){var sourcesHtml="";let updatedSeason=season<10?"0"+season:season,updatedEpisode=episode<10?"0"+episode:episode;$.each(response.data.sources,(function(index,source){var positionAttr="i"===source.type?' data-position="'+source.position+'"':"",extraMeta="g"===source.type?'<span class="extra-meta-source">◎ Global ◉</span>':"",title=source.title?source.title:"Watch Now";sourcesHtml+='<span class="episode" data-postId="'+postId+'" data-season="'+season+'" data-episode="'+episode+'"'+positionAttr+' data-type="'+source.type+'"><span class="title">'+title+"</span>"+extraMeta+"</span>"})),$(".episodes-sources-wrapper").html('<div class="source-info"><div class="source-info-title"><span>You are watching:</span><br>S<span id="current-season">'+updatedSeason+'</span><span class="meta-separator"> | </span>EP<span id="current-episode">'+updatedEpisode+'</span></div></div><div class="episodes-sources">'+sourcesHtml+"</div>")}function toggleEpisodes(season){var seasonContainer=$("#episodes-season-"+season);seasonContainer.show((function(){$(this).find(".episode-box:first").trigger("click")})),$("#episodes-container .episodes").removeClass("active").css("display","none"),seasonContainer.addClass("active").fadeIn(500)}}))}(jQuery);